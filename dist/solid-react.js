var solid="object"==typeof solid?solid:{};solid.react=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=React},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){e.exports=solid.auth},function(e,t){e.exports=solid.data},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e){var t;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}},function(e,t,n){"use strict";n.r(t),n.d(t,"useWebId",(function(){return l})),n.d(t,"useLoggedIn",(function(){return f})),n.d(t,"useLoggedOut",(function(){return h})),n.d(t,"useLDflex",(function(){return P})),n.d(t,"useLDflexValue",(function(){return I})),n.d(t,"useLDflexList",(function(){return V})),n.d(t,"useLiveUpdate",(function(){return m})),n.d(t,"withWebId",(function(){return _})),n.d(t,"evaluateExpressions",(function(){return F})),n.d(t,"evaluateList",(function(){return M})),n.d(t,"LoggedIn",(function(){return q})),n.d(t,"LoggedOut",(function(){return R})),n.d(t,"LoginButton",(function(){return Y})),n.d(t,"LogoutButton",(function(){return z})),n.d(t,"AuthButton",(function(){return G})),n.d(t,"Value",(function(){return H})),n.d(t,"Image",(function(){return J})),n.d(t,"Link",(function(){return Q})),n.d(t,"Label",(function(){return K})),n.d(t,"Name",(function(){return X})),n.d(t,"List",(function(){return Z})),n.d(t,"LiveUpdate",(function(){return ae})),n.d(t,"ActivityButton",(function(){return de})),n.d(t,"LikeButton",(function(){return pe})),n.d(t,"Like",(function(){return pe})),n.d(t,"DislikeButton",(function(){return he})),n.d(t,"Dislike",(function(){return he})),n.d(t,"FollowButton",(function(){return be})),n.d(t,"Follow",(function(){return be})),n.d(t,"UpdateContext",(function(){return b}));var r=n(0),o=n.n(r),i=n(2),c=n.n(i);let u=void 0;const s=new Set,a=(e,t)=>t;function l(e=a){const[t,n]=Object(r.useReducer)(e,u,e);return Object(r.useDebugValue)(u),Object(r.useEffect)(()=>(n(u),s.add(n),()=>s.delete(n)),[]),t}c.a.trackSession(e=>{u=e?e.webId:null;for(const e of s)e(u)});const d=(e,t)=>void 0===t?void 0:null!==t;function f(){const e=l(d);return Object(r.useDebugValue)(e),e}const p=(e,t)=>void 0===t?void 0:null===t;function h(){const e=l(p);return Object(r.useDebugValue)(e),e}var b=o.a.createContext({});function m(){const e=Object(r.useContext)(b);return Object(r.useDebugValue)(e.timestamp||null),e}var v=n(4),y=n.n(v),g=n(5),w=n.n(g);function j(e){return/^https?:[^"]+$/.test(e)&&(e=`["${e}"]`),e}function x(e,t){const n={};for(const r of t)n[r]=e[r];return n}function O(e){return e.displayName||e.name||"Component"}function E({drop:e=!1,timeBetween:t=10,concurrent:n=(e?1:4)}={}){let r=[],o=0;function i(){o=r.length&&setTimeout(i,t),r.splice(0,n).forEach(async({run:e,resolve:t,reject:n})=>{try{t(await e())}catch(e){n(e)}})}return{schedule:function t(n,c=null){if(!Array.isArray(n))return t([n])[0];const u=[],s=n.map(e=>new Promise((t,n)=>u.push({run:e,resolve:t,reject:n,group:c})));return e?r=u:r.push(...u),o||i(),s},clear:function(e){const t=r.length>0;return r=r.filter(t=>void 0!==e&&t.group!==e),t}}}var L=n(3),$=n.n(L);const D=E();class S{constructor(){y()(this,"pending",{}),y()(this,"cancel",!1)}destroy(){this.pending={},this.cancel=!0,D.clear(this)}async evaluate(e,t,n){n({pending:!0,error:void 0});const r=D.schedule([...Object.entries(e).map(([e,t])=>()=>this.evaluateAsValue(e,t,n)),...Object.entries(t).map(([e,t])=>()=>this.evaluateAsList(e,t,n))],this);try{await Promise.all(r)}catch(e){n({error:e})}const o=await Promise.all(r.map(e=>e.catch(e=>(console.warn("@solid/react-components","Expression evaluation failed.",e),!0))));this.cancel||o.some(e=>!e)||0!==Object.keys(this.pending).length||n({pending:!1})}async evaluateAsValue(e,t,n){const r=this.pending[e]=this.resolveExpression(t);let o;try{if(o=await r,this.pending[e]!==r)return!1}finally{this.pending[e]===r&&(delete this.pending[e],n({[e]:o}))}return!0}async evaluateAsList(e,t,n){let r=!0;const o=[],i=this.pending[e]=this.resolveExpression(t),c=()=>!this.cancel&&n({[e]:[...o]}),u=E({timeBetween:100,drop:!0});try{var s,a=!0,l=!1;try{for(var d,f,p=w()(i);a=(d=await p.next()).done,f=await d.value,!a;a=!0){const t=f;if(this.pending[e]!==i)return u.clear(),!1;r=!1,o.push(t),u.schedule(c)}}catch(e){l=!0,s=e}finally{try{a||null==p.return||await p.return()}finally{if(l)throw s}}}finally{const t=r||u.clear();this.pending[e]===i&&(delete this.pending[e],t&&c())}return!0}resolveExpression(e){return e?"string"==typeof e?$.a.resolve(e):e:""}}const k={result:void 0,pending:!0,error:void 0},A={result:[],pending:!0,error:void 0},N={};function P(e,t=!1){const n=l(),o=m(),[{result:i,pending:c,error:u},s]=Object(r.useState)(t?A:k);return Object(r.useDebugValue)(u||i,T),Object(r.useEffect)(()=>{const n=new S,r={result:e};return n.evaluate(t?N:r,t?r:N,e=>s(t=>({...t,...e}))),()=>n.destroy()},[e,o,n&&"string"==typeof e]),[i,c,u]}function T(e){return Array.isArray(e)?e.map(T):`${e}`}function I(e){const[t]=P(e,!1);return Object(r.useDebugValue)(t,T),t}function V(e){const[t]=P(e,!0);return Object(r.useDebugValue)(t,T),t}var C,B,U=n(1),W=n.n(U),_=(C="WithWebId",B=e=>t=>o.a.createElement(e,W()({},t,{webId:l()})),e=>{const t=B(e);return t.displayName=`${C}(${O(e)})`,t});function F(e,t,n){n||([n,t]=[t,[]]),e=e?[...e]:[],t=t?[...t]:[];const r={pending:!0};for(const t of e)r[t]=void 0;for(const e of t)r[e]=[];class i extends o.a.Component{constructor(...e){super(...e),y()(this,"state",r)}componentDidMount(){this.evaluator=new S,this.update=e=>this.setState(e),this.evaluate(e,t)}componentDidUpdate(n){const r=this.props.webId!==n.webId,o=e=>this.props[e]!==n[e]||r&&"string"==typeof this.props[e];this.evaluate(e.filter(o),t.filter(o))}componentWillUnmount(){this.evaluator.destroy()}render(){return o.a.createElement(n,W()({},this.props,this.state))}evaluate(e,t){const{props:n,evaluator:r}=this;(e.length>0||t.length>0)&&r.evaluate(x(n,e),x(n,t),this.update)}}return y()(i,"displayName",`EvaluateExpressions(${O(n)})`),_(i)}function M(e,t){return F([],[e],t)}function q({children:e=null}){return f()?e:null}function R({children:e=null}){return h()?e:null}function Y({popup:e,children:t="Log in",className:n="solid auth login"}){return o.a.createElement("button",{className:n,onClick:()=>c.a.popupLogin({popupUri:e})},t)}function z({children:e="Log out",className:t="solid auth logout"}){return o.a.createElement("button",{className:t,onClick:()=>c.a.logout()},e)}function G({login:e,logout:t,...n}){return f()?o.a.createElement(z,n,t):o.a.createElement(Y,n,e)}function H({src:e,children:t}){const[n,r,i]=P(e);return null!=n?`${n}`:r?t||o.a.createElement("span",{className:"solid value pending"}):i?t||o.a.createElement("span",{className:"solid value error","data-error":i.message}):t||o.a.createElement("span",{className:"solid value empty"})}function J({src:e,defaultSrc:t,children:n=null,...r}){return(e=I(e)||t)?o.a.createElement("img",W()({src:e,alt:""},r)):n}function K({src:e,children:t=null}){return o.a.createElement(H,{src:e&&`${j(e)}.label`},t)}function Q({href:e,children:t,...n}){return e=I(e)||"",t=t||o.a.createElement(K,{src:e&&`[${e}]`},`${e}`),e?o.a.createElement("a",W()({href:e},n),t):t}function X({src:e,children:t=null}){return o.a.createElement(H,{src:e&&`${j(e)}.name`},t)}function Z({src:e,offset:t=0,limit:n=1/0,filter:r=(()=>!0),container:i=(e=>o.a.createElement("ul",null,e)),children:c=((e,t)=>o.a.createElement("li",{key:t},`${e}`))}){const u=V(e).filter(r).slice(t,+t+ +n).map(c);return i?i(u):u}const ee={},te={},ne=new Set;class re{constructor(e){this.subscriber=e}subscribe(...e){for(let t of e)t=t.replace(/#.*/,""),t in ee||(ee[t]=new Set,"*"!==t?oe(t):ne.forEach(e=>oe(e))),ee[t].add(this.subscriber)}unsubscribe(...e){for(let t of e)t=t.replace(/#.*/,""),t in ee&&ee[t].delete(this.subscriber)}}function oe(e,t={}){const{protocol:n,host:r}=new URL(e);let o=te[r];if(!o){const e=`${n.replace("http","ws")}//${r}/`;te[r]=o=new WebSocket(e),Object.assign(o,{host:r,resources:new Set,reconnectionAttempts:0,reconnectionDelay:1e3,enqueue:ie,onmessage:ce,onclose:ue,ready:new Promise(e=>{o.onopen=()=>{o.reconnectionAttempts=0,o.reconnectionDelay=1e3,e()}})},t)}o.resources.add(e),o.enqueue(`sub ${e}`)}async function ie(e){await this.ready,this.send(e)}function ce({data:e}){const t=/^pub +(.+)/.exec(e);if(!t)return;const n=t[1];$.a.clearCache(n);const r={timestamp:new Date,url:n};for(const e of ee[n]||[])e(r);for(const e of ee["*"]||[])e(r)}async function ue(){delete te[this.host],this.reconnectionAttempts<6&&(await new Promise(e=>setTimeout(e,this.reconnectionDelay)),this.resources.forEach(e=>oe(e,{reconnectionAttempts:this.reconnectionAttempts+1,reconnectionDelay:2*this.reconnectionDelay})))}c.a.on("request",e=>{ne.has(e)||("*"in ee&&oe(e),ne.add(e))});const{Provider:se}=b;function ae({subscribe:e="*",children:t=null}){const n=function(...e){const[t,n]=Object(r.useState)({});return Object(r.useDebugValue)(t.timestamp||null),Object(r.useEffect)(()=>{const t=new re(n);return t.subscribe(...e),()=>t.unsubscribe(...e)},e),t}(..."string"!=typeof e?e:/\S/.test(e)?e.trim().split(/\s+/):[]);return o.a.createElement(se,{value:n},t)}const{as:le}=$.a.context;function de({activityType:e=`${le}Like`,object:t=`[${window.location.href}]`,children:n,shortName:i=/\w*$/.exec(e)[0],className:c=`solid activity ${i.toLowerCase()}`,activateText:u=i,deactivateText:s=u,activateLabel:a=(n?[u," ",n]:u),deactivateLabel:l=(n?[s," ",n]:s),...d}){t=j(t);const[f,p]=Object(r.useState)(),h=I(`${t}.findActivity("${e}")`);return void 0===f&&h&&p(!0),c=`${c} ${f?"performed":""}`,o.a.createElement("button",W()({className:c,onClick:async function(){p(!f);try{const n=f?"delete":"create";await $.a.resolve(`${t}.${n}Activity("${e}")`),p(!f)}catch(e){p(f),console.warn("@solid/react-components",e)}}},d),f?l:a)}function fe(e,t,n,r){const i=`${le}${e}`;return({object:e,children:c=(e?null:"this page"),activateText:u=t,deactivateText:s=(c?n:r),...a})=>o.a.createElement(de,W()({},a,{activityType:i,object:e,children:c,activateText:u,deactivateText:s}))}var pe=fe("Like","Like","You liked","Liked"),he=fe("Dislike","Dislike","You disliked","Disliked"),be=fe("Follow","Follow","You follow","Following")}]);
//# sourceMappingURL=solid-react.js.map